---
- name: containerd | Install required packages
  apt:
    name: "{{ item }}"
    state: present
  with_items:
    - libseccomp2
    - ethtool

- name: containerd | Download files
  include_role:
    name: download
  vars:
    download_container: false
    skip_kubeadm_images: true

- name: containerd | Unpack containerd release tarball
  unarchive:
    src: "{{ local_release_dir }}/cri-containerd-cni-{{ containerd_version }}.linux-amd64.tar.gz"
    dest: /
    remote_src: true
    creates: /etc/systemd/system/containerd.service

- name: containerd | Start containerd
  systemd:
    name: containerd
    state: started

- name: containerd | Unpack crictl release tarball
  unarchive:
    src: "{{ local_release_dir }}/crictl-{{ crictl_version }}-linux-amd64.tar.gz"
    dest: /usr/local/bin
    remote_src: true
